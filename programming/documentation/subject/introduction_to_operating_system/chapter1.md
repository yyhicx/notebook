# 操作系统简介

1.  [什么是操作系统](#什么是操作系统)
2.  [操作系统的发展](#操作系统的发展)
3.  [操作系统的特征](#操作系统的特征)
4.  [操作系统的功能](#操作系统的功能)
5.  [操作系统的体系结构](#操作系统的体系结构)
6.  [指令的执行](#指令的执行)

## 什么是操作系统

操作系统（Operating System，OS）是一种复杂的系统软件，是不同程序代码、数据结构、数据初始化文件的集合，可执行。

操作系统提供计算机用户与计算机硬件之间的接口，并管理计算机软件和硬件资源。

操作系统是覆盖在裸机上的第一层软件，编译程序、数据库管理系统及其他应用程序都运行在操作系统之上，操作系统为这些软件提供运行环境。

用户与硬件之间的接口：

*   计算机的所有功能最终都是由硬件的操作来实现的。应用程序在操作系统上运行，对硬件的控制过程都封装在操作系统的核心程序中。有操作系统对硬件的抽象，且操作系统为应用程序提供运行环境，在操作系统之上编写和运行应用程序就简单了。
*   操作系统必须完成的两个主要目的：与硬件部分相互作用，为包含在硬件平台上的所有底层可编程部件提供服务。为运行在计算机系统上的应用程序提供执行环境。

资源的管理者：

*   现代计算机系统支持多任务，允许在同一个系统内同时驻留多个应用程序。多个应用程序共同使用计算机软硬件资源时，需要操作系统对这些资源进行有效的管理。
*   处理机管理：程序的执行需要依靠处理机，任意时刻处理机都只能执行一个程序流。在单处理机系统中执行多个程序流，须由操作系统的处理机调度程序来管理处理机的分配，以使多个程序共享处理机，从宏观上看多个程序能同时顺序执行。
*   内存管理：在多任务系统中，内存可被多个应用程序共同占用，如何分配内存（为多个应用程序分配内存并使不同应用程序的地址空间互不干扰），如何回收内存，以及完成逻辑地址到物理地址到转换，以上都是内存管理要完成的功能。
*   设备管理：接受用户I/O请求、为用户分配I/O设备、管理I/O缓存和驱动I/O设备等功能。
*   文件管理：大量需长时间保留的信息以文件的形式存放在外存中，操作想听通过文件管理完成外存空间的分配、回收、文件的按名存取、文件的组织、共享与保护等功能。

## 操作系统的发展

操作系统的发展从时间顺序上经历了无操作系统到单道批处理系统，多道程序系统（多道批处理系统，分时系统）的发展过程。

无操作系统：第一代计算机（1945～1955年）使用电子管作为主要的电子器件，无内存，无操作系统。

单道批处理系统：第二代计算机（1955年～1965年）使用晶体管作为主要的电子器件，开始使用磁性存储设备，内外存容量增加。

多道程序系统：

*   多道批处理系统：早期的多道程序系统不具有交互功能，被称为多道批处理系统。程序员提交作业后，在作业运行结束、输出结果之前，无法观察和控制作业的运行。
*   分时系统：多个用户可以同时通过不同的终端使用主机，主机可以快速响应常用命令。在分时系统中同时登陆系统的多个用户提交的作业轮流执行，每个作业都是运行一小段时间就把主机资源让给另一个作业运行一段时间，多个作业交替执行，分时使用主机资源。对于终端用户来说，感觉自己独占计算机资源，并且实现用户与主机的及时交互。

微机操作系统：随着个人计算机的出现，微机操作系统应运而生。第一个微机操作系统是Inter公司的CP/M系统，用于Inter 8080。之后诞生了MS-DOS、Windows、Linux、MacOS等操作系统。

实时操作系统：对于实施系统来说，不仅要求系统能正确地计算出结果，而且要求必须在规定时间内计算出正确结果。如果计算结果正确，但时间超过了规定时间，依然被认为计算出错。如VxWorks，eCos和RTLinux等。

批处理系统、分时系统、实时系统的特点：

*   单道批处理系统的特点：内存中只有一道作业，可以自动处理程序。拥有自动性、顺序性和单道性。
    *   自动性：自动地将作业从外存中装入内存运行。
*   多道批处理系统的特点：用户提交的作业都先存放在外存中并排成一个队列，该队列被称为“后备作业队列”。由操作系统的作业调度程序按照一定策略从后备作业队列中选择若干个作业调入内存，使它们共享CPU和系统中的各种资源，以达到提高资源利用率和系统吞吐量的目的。拥有多道性、无序性、调度性和复杂性。
    *   无序性：多个作业完成的先后的顺序与它们进入内存的顺序之间没有严格的对应关系。
    *   调度性：多道程序系统必须具有作业调度（作业从后备作业队列装入内存）和进程调度（选择内存中的进程被CPU执行）功能。
*   分时系统的特点：允许多个用户通过终端同时使用计算机。拥有多路性、独立性、及时性和交互性。
*   实时系统的特点：及时响应外部事件的请求，在规定的时间内完成对该事件的处理，并控制所有实时任务协调一致地运行。拥有多路性、独立性、及时性、交互性和可靠性。

## 操作系统的特征

现代操作系统都支持多任务，具有并发、共享、虚拟和异步性特征。

并发：指两个或多个事件在同一时间间隔内发生。而并行是指多个事件同时发生。

共享：指系统中的资源可供内存中多个并发执行的进程共同使用。资源共享分为互斥共享和同时共享。

虚拟：指通过某种技术把一个物理实体变成若干逻辑上的对应物。

异步：内存中的每个程序何时运行，何时暂停，何时完成都是不可预知的。

## 操作系统的功能

内存管理：内存管理的主要任务是为多道程序的运行提供良好的环境，方便用户使用内存，提高内存的利用率，以及从逻辑上扩充内存以实现虚拟内存。

*   内存分配：为每道程序分配内存空间。
    *   静态分配：内存预先划分成固定大小和数量的区域供程序使用。
    *   动态分配：根据进程的请求分配，内存中分区大小和数量都是动态变化的。
*   内存保护：一是使操作系统内核的空间不会被用户随意访问，以保证系统的安全和稳定；二是确保每道用户程序都在自己的内存空间中运行，互不干扰。
*   地址映射：CPU执行程序过程中访问内存时，需要把程序的逻辑地址转变成物理地址，这个转换的过程称为地址映射。
    *   逻辑地址：目标程序中的地址称为逻辑地址，从0开始。
    *   物理地址：内存中的单元地址称为物理地址。CPU访问内存需要将物理地址送入地址总线，以选中要访问的内存单元。
*   内存扩充：借助于虚拟存储技术，从逻辑上扩充内存容量，使系统能够向用户提供比物理内存大的存储空间。
    *   请求调入功能：在进程开始运行之前，不是装入所有指令，而是装入部分初始需要的指令，之后再根据进程的需要，动态地装入其他指令。
    *   置换功能：当内存空间紧张时，根据特定算法将部分不大需要的指令调出内存，再将需要的指令置换进来。

进程管理：进程是程序的执行实体。

设备管理：完成用户的I/O请求，为用户分配I/O设备。设备管理的主要功能有缓冲管理、设备分配、设备处理、设备独立性和虚拟设备。

*   由设备驱动程序来实现CPU与设备控制器之间的通信。
*   设备独立性：使应用程序独立于物理设备。
*   虚拟设备：把一个物理设备变换成多个对应的逻辑设备，使一个物理设备能供多个用户共享。

文件管理：

*   文件存储空间的管理：为每个文件分配必要的外存空间，提高外存利用率，并能够有助于提高访问文件的速度。
*   目录管理：为每个文件建立目录项并对众多目录项进行有效组织。
*   文件的读、写和存取控制：根据用户的请求，从外存中读取数据或数据写入外存。

提供用户接口：为了方便用户使用操作系统，操作系统向用户提供了用户与操作系统之间的接口。分为命令接口、图形用户接口和程序接口（提供给程序员的系统调用的接口）。

## 操作系统的体系结构

软件体系结构：是一个复杂软件系统的高层结构，为软件系统提供了一个结构、行为和属性的高级抽象。明确清晰的软件体系结构是一条贯穿软件系统整个生命周期的主线，是软件设计成功的基础和关键，也是对软件大型化、复杂化趋势的一种很好的应对决策。

操作系统体系结构：是研究整个操作系统内各组成成分，以及成分间和成分内部存在的相互关系。

*   简单的监控程序模型：任意时刻系统中只能运行一个任务，整个系统的所有功能全部集中在一个单一模块中。
*   单体结构模型：是软件工程出现以前的早期操作系统及目前一些小型操作系统采用的体系结构，所有的软件和数据结构都放置在一个逻辑模块中，对外层的用户提供一个完整的内核界面--系统调用。具有单体结构模型的典型操作系统有UNIX、MS-DOS、Linux等。
*   层次结构模型：将操作系统分解成多个小的、容易理解的层，系统功能被隔阂在不同的层中，每一层提供对系统功能的部分抽象，然后采用单向调用的顺序，形成一连串彼此连续的对系统功能的“抽象串”，最终形成对整个系统的完整抽象。
*   客户/服务器模型与微内核结构：把传统操作系统内核中的一些组成部分放到内核之外作为一个独立的服务器进程来实现，在微内核中只保留了操作系统最基本的功能。目前微内核的操作系统一是向通用方向发展（如Windows NT），二是向嵌入式发展。
*   动态可扩展结构模型：在运行的过程中，能够动态地实现系统行为扩展的结构，也可称之为弹性结构。

## 指令的执行

程序是指令的集合，程序的执行就是按照某种控制流执行指令的过程。

指令周期：一个单一指令需要的处理称为指令周期，分为取指周期和执行周期两个步骤。

取指令：在每个指令周期开始时，处理器从存储器中取一条指令。

执行指令：取到的指令被放置在处理器的指令寄存器IR中。

CPU中的部分寄存器：

*   程序计数器（PC），存放下一条将要执行指令的地址。
*   指令寄存器（IR），存正在执行的指令。
*   累加器（AC），临时存储体和进行累加操作。

程序执行的过程就是反复取指令和执行指令的过程。
